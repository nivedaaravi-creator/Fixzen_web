<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FixZen - Login</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = { theme: { extend: { keyframes: { fadeInUp: { '0%': {opacity:0, transform:'translateY(10px)'}, '100%': {opacity:1, transform:'translateY(0)'} } }, animation: { fadeInUp: 'fadeInUp .6s ease-out both' } } } }
    </script>
    <style>
        body { 
            background: var(--gradient-hero);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            margin: 0; 
        }
        .auth-wrap { min-height: 100vh; display: grid; place-items: center; padding: 20px; }
        .auth-container { 
            width: 360px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow-xl);
        }
        h2 { color: var(--brand); margin-bottom: 20px; text-align: center; }
        form { text-align: left; }
        .message { margin-top: 12px; font-weight: 600; }
        .error { color: #dc2626; }
        .success { color: #16a34a; }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Card pop */
        .card-pop { animation: cardPop .6s cubic-bezier(.22,.92,.29,1.12) both; }
        @keyframes cardPop { 0% { transform: translateY(10px) scale(.98); opacity: 0; } 100% { transform: translateY(0) scale(1); opacity: 1; } }
    </style>
</head>

<body>
    <div class="navbar">
        <div class="container navbar-inner">
            <div class="logo">FixZen</div>
            <div class="nav-links">
                <a href="{{ url_for('home') }}">Home</a>
                <a class="pill" href="{{ url_for('signup_page') }}">Sign Up</a>
            </div>
        </div>
    </div>
    <div class="auth-wrap">
    <div class="auth-container card motion-safe:animate-fadeInUp card-pop" style="backdrop-filter: blur(6px); background: rgba(255,255,255,.9)">
        <h2>Login</h2>
        
        <!-- Flash messages routed to toasts -->
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                {% for message in messages %}
                    <div data-flash data-type="success" style="display:none">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <form method="POST" action="/login">
            <label for="email">Email</label>
            <input type="email" id="email" name="email" required>

            <label for="password">Password</label>
            <div style="position:relative">
                <input type="password" id="password" name="password" required>
                <button type="button" id="togglePass" class="btn btn-secondary" style="position:absolute; right:6px; top:6px; padding:6px 10px">Show</button>
            </div>

            <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
                <a href="#" onclick="openModal('forgotModal'); return false;">Forgot password?</a>
            </div>

            <button type="submit" class="btn btn-primary" style="width:100%">Login</button>
        </form>
        
        <p>Don't have an account? <a href="{{ url_for('signup_page') }}">Sign Up</a></p>
    </div>
    <!-- Forgot Password Modal -->
    <div class="modal-backdrop" id="forgotModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Reset Password</div>
                <button class="btn btn-secondary" onclick="closeModal('forgotModal')">Close</button>
            </div>
            <div class="modal-body">
                <label for="forgot-email">Enter your email</label>
                <input id="forgot-email" type="email" placeholder="you@example.com">
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('forgotModal')">Cancel</button>
                <button class="btn btn-primary" onclick="closeModal('forgotModal');">Send Link</button>
            </div>
        </div>
    </div>
    </div>
    <script>
        document.getElementById('togglePass')?.addEventListener('click', function(){
            const input = document.getElementById('password');
            if (!input) return;
            const is = input.getAttribute('type') === 'password';
            input.setAttribute('type', is ? 'text' : 'password');
            this.textContent = is ? 'Hide' : 'Show';
        });
    </script>
    <script type="module">
        import { openModal, closeModal } from '{{ url_for('static', filename='app.js') }}';
        window.openModal = openModal;
        window.closeModal = closeModal;
    </script>
    <script type="module" src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>